<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" xml:lang="en-us">
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta content="public" name="security" />
<meta content="index,follow" name="Robots" />
<meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<meta content="reference" name="DC.Type" />
<meta name="DC.Title" content="CREATE PROCEDURE statement" />
<meta name="abstract" content="The CREATE PROCEDURE statement creates a Java stored procedure, which you can then call using the CALL PROCEDURE statement." />
<meta name="description" content="The CREATE PROCEDURE statement creates a Java stored procedure, which you can then call using the CALL PROCEDURE statement." />
<meta content="CREATE PROCEDURE statement, CREATE PROCEDURE, SQL statements, procedures, creating" name="DC.subject" />
<meta content="CREATE PROCEDURE statement, CREATE PROCEDURE, SQL statements, procedures, creating" name="keywords" />
<meta scheme="URI" name="DC.Relation" content="crefsqlj95081.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqljcreateaggregate.html" />
<meta scheme="URI" name="DC.Relation" content="rrefcreatefunctionstatement.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj20937.html" />
<meta scheme="URI" name="DC.Relation" content="rrefcreaterole.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj31580.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqljcreatesequence.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqljcreatesynonym.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj24513.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj43125.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqljcreatetype.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj15446.html" />
<meta content="XHTML" name="DC.Format" />
<meta content="rrefcreateprocedurestatement" name="DC.Identifier" />
<meta content="en-us" name="DC.Language" />
<link href="commonltr.css" type="text/css" rel="stylesheet" />
<title>CREATE PROCEDURE statement</title>
</head>
<body id="rrefcreateprocedurestatement"><a name="rrefcreateprocedurestatement"><!-- --></a>


<h1 class="topictitle1">CREATE PROCEDURE statement</h1>



<div><p>The CREATE PROCEDURE statement creates a Java stored procedure, which
you can then call using the CALL PROCEDURE statement.</p>

<div class="section"><p>The procedure owner and the 
<a href="rrefattrib26867.html#rrefattrib26867">database owner</a>
automatically gain the EXECUTE privilege
on the procedure, and are able to grant this privilege to other users. The
EXECUTE privileges cannot be revoked from the procedure and database owners.</p>

<p>For details on how <span>Derby</span>
matches procedures to Java methods, see
<a href="rrefsqljargmatching.html#rrefsqljargmatching">Argument matching</a>. For
information on how stored procedures interact with deferrable constraints, see
<a href="rrefsqlj13590.html#rrefsqlj13590__deferrableconstraints">Deferrable constraints</a>.</p>

</div>

<div class="section"><h2 class="sectiontitle">Syntax</h2>
<pre><strong>CREATE PROCEDURE <em><a href="rrefprocedurename.html#rrefprocedurename.dita">procedureName</a></em> ( [ <em><a href="rrefcreateprocedurestatement.html#rrefcreateprocedurestatement__rrefcrproprocedureparameter">procedureParameter</a></em>
   [ , <em><a href="rrefcreateprocedurestatement.html#rrefcreateprocedurestatement__rrefcrproprocedureparameter">procedureParameter</a></em> ]* [...] ] )
[ <em><a href="rrefcreateprocedurestatement.html#rrefcreateprocedurestatement__rrefcrproprocedureelement">procedureElement</a></em> ]*</strong>
</pre>

<p>An ellipsis (<samp class="codeph">...</samp>) after the last parameter indicates that
the Java method supports trailing optional arguments, called
<dfn class="term">varargs</dfn>. The ellipsis indicates that the method may be invoked
with zero or more trailing values, all having the data type of the last
argument.</p>
</div>

<div class="example" id="rrefcreateprocedurestatement__rrefcrproprocedureparameter"><a name="rrefcreateprocedurestatement__rrefcrproprocedureparameter"><!-- --></a><h2 class="sectiontitle">procedureParameter</h2> <pre><strong>[ { IN | OUT | INOUT } ] [ <em>parameterName</em> ] <em>dataType</em></strong></pre>
</div>

<div class="section"><p>The default value for a parameter is IN. A <em>parameterName</em> must be
unique within a procedure.</p>
<p>The syntax of <em>dataType</em> is described
in <a href="crefsqlj31068.html#crefsqlj31068">Data types</a>.</p>
<div class="note"><span class="notetitle">Note: </span>The data
types BLOB, CLOB, LONG VARCHAR, LONG VARCHAR FOR BIT DATA, and XML are not
allowed as parameters in a CREATE PROCEDURE statement.</div>
</div>

<div class="example" id="rrefcreateprocedurestatement__rrefcrproprocedureelement"><a name="rrefcreateprocedurestatement__rrefcrproprocedureelement"><!-- --></a><h2 class="sectiontitle">procedureElement</h2> 
<pre><strong>{ 
    [ DYNAMIC ] RESULT SETS <em><a href="rrefsqlj10696.html#rrefsqlj10696">integer</a></em> |
    LANGUAGE JAVA |
    { DETERMINISTIC | NOT DETERMINISTIC } |
    <a href="rrefsqljexternalname.html#rrefsqljexternalname">EXTERNAL NAME</a> <em>singleQuotedString</em> |
    PARAMETER STYLE { JAVA | DERBY } |
    EXTERNAL SECURITY { DEFINER | INVOKER } |
    { NO SQL | MODIFIES SQL DATA | CONTAINS SQL | READS SQL DATA }
}</strong></pre>
</div>

<div class="section"><div class="p">The procedure elements may appear in any order, but each type
of element can only appear once. A procedure definition must contain these
elements: <ul>
<li><strong>LANGUAGE</strong></li>

<li><strong>EXTERNAL NAME</strong></li>

<li><strong>PARAMETER STYLE</strong></li>

</ul>
</div>
</div>

<div class="section"><h2 class="sectiontitle">DYNAMIC RESULT SETS <em>integer</em></h2> <p>Indicates the
estimated upper bound of returned result sets for the procedure. Default is
no (zero) dynamic result sets. If the procedure takes varargs, the value must
be zero.</p>
</div>

<div class="section"><h2 class="sectiontitle">LANGUAGE JAVA</h2> <p>The database manager will call the
procedure as a public static method in a Java class.</p>
</div>

<div class="section"><h2 class="sectiontitle">DETERMINISTIC, NOT DETERMINISTIC</h2>
<p>DETERMINISTIC declares that the procedure is deterministic, meaning that with
the same set of input values, it always computes the same result. The default is
NOT DETERMINISTIC. <span>Derby</span>
cannot recognize whether an operation is actually deterministic, so you must
take care to specify this element correctly.</p>

</div>

<div class="section"><h2 class="sectiontitle">EXTERNAL NAME <em>singleQuotedString</em></h2>
<p>The <em>singleQuotedString</em> specified by the <a href="rrefsqljexternalname.html#rrefsqljexternalname">EXTERNAL NAME clause</a> describes
the Java method to be called when the procedure is executed.</p>
</div>

<div class="section"><h2 class="sectiontitle">PARAMETER STYLE</h2>
<dl>

<dt class="dlterm">JAVA</dt>

<dd>The procedure will use a parameter-passing convention that conforms to the
Java language and SQL Routines specification. INOUT and OUT parameters will be
passed as single entry arrays to facilitate returning values. Result sets are
returned through additional parameters to the Java method of type
<em>java.sql.ResultSet[]</em> that are passed single entry arrays.
<p><span>Derby</span> does
not support long column types (for example, LONG VARCHAR, BLOB, and so on).
An error will occur if you try to use one of these long column types.</p>
</dd>



<dt class="dlterm">DERBY</dt>

<dd>The PARAMETER STYLE must be DERBY if and only if an ellipsis
(<samp class="codeph">...</samp>) appears at the end of the argument list.</dd>


</dl>

</div>

<div class="section" id="rrefcreateprocedurestatement__rrefcrprodefrts"><a name="rrefcreateprocedurestatement__rrefcrprodefrts"><!-- --></a><h2 class="sectiontitle">EXTERNAL SECURITY</h2>
<p>If SQL authorization mode is enabled, a procedure runs by default with the
privileges specified for the user who invokes the procedure (invoker's rights).
To specify that the procedure should run with the privileges specified for the
user who defines the procedure (definer's rights), create the procedure with
EXTERNAL SECURITY DEFINER. Those privileges include the right to set the current
role to a role for which the definer has privileges. When the procedure is first
invoked, no role is set; even if the invoker has set a current role, the
procedure running with definer's rights has no current role set initially.</p>

<p>See <em><a href="rrefpropersqlauth.html#rrefpropersqlauth">derby.database.sqlAuthorization</a></em> for
details about setting SQL authorization mode.</p>

<p>When a procedure with definer's rights is called, the current default schema
is set to the eponymously named schema of the definer. For example, if the
defining user is called OWNER, the default schema will also be set to OWNER.</p>

<p>When a procedure with invoker's rights is called, the current default
schema and current role are unchanged initially within the procedure. Similarly,
if SQL authorization mode is not enabled, the current default schema is
unchanged initially within the procedure.</p>

<p>When the call returns, any changes made inside the procedure to the default
current schema (and current role, if relevant) are reset (popped).</p>

<p>If SQL authorization mode is not enabled, an attempt to create a procedure
with EXTERNAL SECURITY will result in an error.</p>

</div>

<div class="section"><h2 class="sectiontitle">NO SQL, CONTAINS SQL, READS SQL DATA, MODIFIES SQL DATA </h2> <p>Indicates
        whether the stored procedure issues any SQL statements and, if so, what type.
    MODIFIES SQL DATA is the default value.
    A stored procedure which issues a statement which does not conform to
    the declared SQL statement level will cause Derby to throw an exception.
        </p>
 <dl>

<dt class="dlterm">NO SQL</dt>

<dd>Indicates that the stored procedure cannot execute any SQL statements</dd>


<dt class="dlterm">CONTAINS SQL</dt>

<dd>Indicates that SQL statements that neither read nor modify SQL data can
    be executed by the stored procedure.
</dd>


<dt class="dlterm">READS SQL DATA </dt>

<dd>Indicates that SQL statements that do not modify SQL data (for
    example, SELECT statements) can be included in the stored procedure.
</dd>


<dt class="dlterm">MODIFIES SQL DATA</dt>

<dd>Indicates that the stored procedure can execute any SQL statement.</dd>

</dl>
</div>

<div class="section"><h2 class="sectiontitle">Examples</h2> <pre><strong>CREATE PROCEDURE SALES.TOTAL_REVENUE(IN S_MONTH INTEGER,
IN S_YEAR INTEGER, OUT TOTAL DECIMAL(10,2))
PARAMETER STYLE JAVA READS SQL DATA LANGUAGE JAVA EXTERNAL NAME 
'com.example.sales.calculateRevenueByMonth'</strong></pre>


<pre><strong>
CREATE PROCEDURE VARARGPROC
( IN a INT, IN b INT, IN c BIGINT ... )
LANGUAGE JAVA
PARAMETER STYLE DERBY
READS SQL DATA
EXTERNAL NAME 'Procs.varargProc'
</strong></pre>

</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="crefsqlj95081.html" title="">CREATE statements</a></div>
</div>
<div class="relref"><strong>Related reference</strong><br />
<div><a href="rrefsqljcreateaggregate.html" title="The CREATE DERBY AGGREGATE statement creates a user-defined aggregate (UDA). A UDA is a custom aggregate operator.">CREATE DERBY AGGREGATE statement</a></div>
<div><a href="rrefcreatefunctionstatement.html" title="The CREATE FUNCTION statement creates a Java function, which you can then use in an expression.">CREATE FUNCTION statement</a></div>
<div><a href="rrefsqlj20937.html" title="A CREATE INDEX statement creates an index on a table. Indexes can be on one or more columns in the table.">CREATE INDEX statement</a></div>
<div><a href="rrefcreaterole.html" title="The CREATE ROLE statement creates an SQL role. Roles are useful for administering privileges when a database has many users.">CREATE ROLE statement</a></div>
<div><a href="rrefsqlj31580.html" title="The CREATE SCHEMA statement creates a schema, which is a way to logically group objects in a single collection and to provide a unique namespace for objects.">CREATE SCHEMA statement</a></div>
<div><a href="rrefsqljcreatesequence.html" title="The CREATE SEQUENCE statement creates a sequence generator, which is a mechanism for generating exact numeric values, one at a time.">CREATE SEQUENCE statement</a></div>
<div><a href="rrefsqljcreatesynonym.html" title="The CREATE SYNONYM statement provides an alternate name for a table or a view that is present in the same schema or another schema.">CREATE SYNONYM statement</a></div>
<div><a href="rrefsqlj24513.html" title="The CREATE TABLE statement creates a table. Tables contain columns and constraints, rules to which data must conform.">CREATE TABLE statement</a></div>
<div><a href="rrefsqlj43125.html" title="The CREATE TRIGGER statement creates a trigger, which defines a set of actions that are executed when a database event occurs on a specified table.">CREATE TRIGGER statement</a></div>
<div><a href="rrefsqljcreatetype.html" title="The CREATE TYPE statement creates a user-defined type (UDT). A UDT is a serializable Java class whose instances are stored in columns.">CREATE TYPE statement</a></div>
<div><a href="rrefsqlj15446.html" title="The CREATE VIEW statement creates a view, which is a virtual table formed by a query.">CREATE VIEW statement</a></div>
</div>
</div>

</body>
</html>
